<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-
1">
<title>API documentation for Storm</title>
<style type="text/css">

BODY { background-color: #e0e0ff; }
H1 { text-align: center; }
CAPTION { font-weight: bold }
A { color: #000066; text-decoration: none; font-weight: bold; }
A.qindex {}
A.qindexRef {}
A.el { text-decoration: none; font-weight: bold }
A.elRef { font-weight: bold }
A.code { text-decoration: none; font-weight: normal; color: #4444ee }
A.codeRef { font-weight: normal; color: #4444ee }
A:hover { text-decoration: underline; background-color: #f2f2ff }
A:visited { color: #000066; }
DL.el { margin-left: -1cm }
DIV.fragment { width: 100%; border: none; background-color: #eeeeee }
DIV.ah { background-color: black; font-weight: bold; color: #ffffff; margin-bottom: 3px; margin-top: 3px }
TD.md { background-color: #f2f2ff; font-weight: bold; }
TD.mdname1 { background-color: #f2f2ff; font-weight: bold; color: #602020; }
TD.mdname { background-color: #f2f2ff; font-weight: bold; color: #602020; width: 600px; }
DIV.groupHeader { margin-left: 16px; margin-top: 12px; margin-bottom: 6px; font-weight: bold }
DIV.groupText { margin-left: 16px; font-style: italic; font-size: smaller }
TR, TD, TABLE { padding: 0 0 0 0; margin: 0 0 0 0; }
TD.indexkey { 
   background-color: #d0d0ff; 
   font-weight: bold; 
   padding-right  : 10px; 
   padding-top    : 2px; 
   padding-left   : 10px; 
   padding-bottom : 2px; 
   margin-left    : 0px; 
   margin-right   : 0px; 
   margin-top     : 0px; 
   margin-bottom  : 0px  
}
TD.indexvalue { 
   background-color: #d0d0ff; 
   font-style: italic; 
   padding-right  : 10px; 
   padding-top    : 2px; 
   padding-left   : 10px; 
   padding-bottom : 2px; 
   margin-left    : 0px; 
   margin-right   : 0px; 
   margin-top     : 0px; 
   margin-bottom  : 0px  
}
span.keyword       { color: #008000 }
span.keywordtype   { color: #604020 }
span.keywordflow   { color: #e08000 }
span.comment       { color: #800000 }
span.preprocessor  { color: #806020 }
span.stringliteral { color: #002080 }
span.charliteral   { color: #008080 }

BODY, TD { font-family: tahoma, verdana, arial, sansserif; font-size: 11px; }

</style>
</head><body>
<center><a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="functions.html">Data Structure Members List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>


<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>mc146818.h</h1><a href="mc146818_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/* mc146818rtc.h - register definitions for the Real-Time-Clock / CMOS RAM</span>
00002 <span class="comment"> * Copyright Torsten Duwe &lt;duwe@informatik.uni-erlangen.de&gt; 1993</span>
00003 <span class="comment"> * derived from Data Sheet, Copyright Motorola 1984 (!).</span>
00004 <span class="comment"> * It was written to be part of the Linux operating system.</span>
00005 <span class="comment"> */</span>
00006 <span class="comment">/* permission is hereby granted to copy, modify and redistribute this code</span>
00007 <span class="comment"> * in terms of the GNU Library General Public License, Version 2 or later,</span>
00008 <span class="comment"> * at your option.</span>
00009 <span class="comment"> */</span>
00010 
00011 <span class="preprocessor">#ifndef _MC146818RTC_H</span>
00012 <span class="preprocessor"></span><span class="preprocessor">#define _MC146818RTC_H</span>
00013 <span class="preprocessor"></span>
00014 <span class="preprocessor">#ifndef RTC_PORT</span>
<a name="l00015"></a><a class="code" href="mc146818_8h.html#a0">00015</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_PORT(x) (0x70 + x)</span>
<a name="l00016"></a><a class="code" href="mc146818_8h.html#a1">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_ALWAYS_BCD  1</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00018 <span class="preprocessor"></span>
<a name="l00019"></a><a class="code" href="mc146818_8h.html#a44">00019</a> <span class="keyword">static</span> <span class="keyword">inline</span> <a class="codeRef" doxygen="common.tag:/root/Chaos/Documentation/Common/html/" href="/root/Chaos/Documentation/Common/html/stdint_8h.html#a66">uint8_t</a> <a class="code" href="mc146818_8h.html#a44">cmos_read</a> (uint8_t offset) 
00020 {
00021     <a class="codeRef" doxygen="common.tag:/root/Chaos/Documentation/Common/html/" href="/root/Chaos/Documentation/Common/html/port_8h.html#a0">port_uint8_out</a> (<a class="code" href="mc146818_8h.html#a0">RTC_PORT</a> (0), offset);
00022     
00023     <span class="keywordflow">return</span> <a class="codeRef" doxygen="common.tag:/root/Chaos/Documentation/Common/html/" href="/root/Chaos/Documentation/Common/html/port_8h.html#a3">port_uint8_in</a> (<a class="code" href="mc146818_8h.html#a0">RTC_PORT</a>(1));
00024 }
00025 
<a name="l00026"></a><a class="code" href="mc146818_8h.html#a45">00026</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="mc146818_8h.html#a45">cmos_write</a> (uint8_t addr, uint8_t value) 
00027 {
00028     <a class="codeRef" doxygen="common.tag:/root/Chaos/Documentation/Common/html/" href="/root/Chaos/Documentation/Common/html/port_8h.html#a0">port_uint8_out</a> (<a class="code" href="mc146818_8h.html#a0">RTC_PORT</a> (0), addr);
00029     <a class="codeRef" doxygen="common.tag:/root/Chaos/Documentation/Common/html/" href="/root/Chaos/Documentation/Common/html/port_8h.html#a0">port_uint8_out</a> (<a class="code" href="mc146818_8h.html#a0">RTC_PORT</a> (1), value );
00030 }
00031 
<a name="l00032"></a><a class="code" href="mc146818_8h.html#a46">00032</a> <span class="keyword">static</span> <span class="keyword">inline</span> <a class="codeRef" doxygen="common.tag:/root/Chaos/Documentation/Common/html/" href="/root/Chaos/Documentation/Common/html/stdint_8h.html#a66">uint8_t</a> <a class="code" href="mc146818_8h.html#a46">convert_bcd_to_bin</a> (uint8_t value)
00033 {
00034     <span class="keywordflow">return</span> (((value) &amp; 0xF) + ((value) &gt;&gt; 4) * 10);
00035 }
00036 
00037 <span class="comment">/**********************************************************************</span>
00038 <span class="comment"> * register summary</span>
00039 <span class="comment"> **********************************************************************/</span>
<a name="l00040"></a><a class="code" href="mc146818_8h.html#a2">00040</a> <span class="preprocessor">#define RTC_SECONDS            0</span>
<a name="l00041"></a><a class="code" href="mc146818_8h.html#a3">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_SECONDS_ALARM      1</span>
<a name="l00042"></a><a class="code" href="mc146818_8h.html#a4">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_MINUTES            2</span>
<a name="l00043"></a><a class="code" href="mc146818_8h.html#a5">00043</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_MINUTES_ALARM      3</span>
<a name="l00044"></a><a class="code" href="mc146818_8h.html#a6">00044</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_HOURS              4</span>
<a name="l00045"></a><a class="code" href="mc146818_8h.html#a7">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_HOURS_ALARM        5</span>
00046 <span class="preprocessor"></span><span class="comment">/* RTC_*_alarm is always true if 2 MSBs are set */</span>
<a name="l00047"></a><a class="code" href="mc146818_8h.html#a8">00047</a> <span class="preprocessor"># define RTC_ALARM_DONT_CARE    0xC0</span>
00048 <span class="preprocessor"></span>
<a name="l00049"></a><a class="code" href="mc146818_8h.html#a9">00049</a> <span class="preprocessor">#define RTC_DAY_OF_WEEK        6</span>
<a name="l00050"></a><a class="code" href="mc146818_8h.html#a10">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_DAY_OF_MONTH       7</span>
<a name="l00051"></a><a class="code" href="mc146818_8h.html#a11">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_MONTH              8</span>
<a name="l00052"></a><a class="code" href="mc146818_8h.html#a12">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_YEAR               9</span>
00053 <span class="preprocessor"></span>
00054 <span class="comment">/* control registers - Moto names</span>
00055 <span class="comment"> */</span>
<a name="l00056"></a><a class="code" href="mc146818_8h.html#a13">00056</a> <span class="preprocessor">#define RTC_REG_A       10</span>
<a name="l00057"></a><a class="code" href="mc146818_8h.html#a14">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_REG_B       11</span>
<a name="l00058"></a><a class="code" href="mc146818_8h.html#a15">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_REG_C       12</span>
<a name="l00059"></a><a class="code" href="mc146818_8h.html#a16">00059</a> <span class="preprocessor"></span><span class="preprocessor">#define RTC_REG_D       13</span>
00060 <span class="preprocessor"></span>
00061 <span class="comment">/**********************************************************************</span>
00062 <span class="comment"> * register details</span>
00063 <span class="comment"> **********************************************************************/</span>
<a name="l00064"></a><a class="code" href="mc146818_8h.html#a17">00064</a> <span class="preprocessor">#define RTC_FREQ_SELECT RTC_REG_A</span>
00065 <span class="preprocessor"></span>
00066 <span class="comment">/* update-in-progress  - set to "1" 244 microsecs before RTC goes off the bus,</span>
00067 <span class="comment"> * reset after update (may take 1.984ms @ 32768Hz RefClock) is complete,</span>
00068 <span class="comment"> * totalling to a max high interval of 2.228 ms.</span>
00069 <span class="comment"> */</span>
<a name="l00070"></a><a class="code" href="mc146818_8h.html#a18">00070</a> <span class="preprocessor"># define RTC_UIP        0x80</span>
<a name="l00071"></a><a class="code" href="mc146818_8h.html#a19">00071</a> <span class="preprocessor"></span><span class="preprocessor"># define RTC_DIV_CTL        0x70</span>
00072 <span class="preprocessor"></span>   <span class="comment">/* divider control: refclock values 4.194 / 1.049 MHz / 32.768 kHz */</span>
<a name="l00073"></a><a class="code" href="mc146818_8h.html#a20">00073</a> <span class="preprocessor">#  define RTC_REF_CLCK_4MHZ 0x00</span>
<a name="l00074"></a><a class="code" href="mc146818_8h.html#a21">00074</a> <span class="preprocessor"></span><span class="preprocessor">#  define RTC_REF_CLCK_1MHZ 0x10</span>
<a name="l00075"></a><a class="code" href="mc146818_8h.html#a22">00075</a> <span class="preprocessor"></span><span class="preprocessor">#  define RTC_REF_CLCK_32KHZ    0x20</span>
00076 <span class="preprocessor"></span>   <span class="comment">/* 2 values for divider stage reset, others for "testing purposes only" */</span>
<a name="l00077"></a><a class="code" href="mc146818_8h.html#a23">00077</a> <span class="preprocessor">#  define RTC_DIV_RESET1    0x60</span>
<a name="l00078"></a><a class="code" href="mc146818_8h.html#a24">00078</a> <span class="preprocessor"></span><span class="preprocessor">#  define RTC_DIV_RESET2    0x70</span>
00079 <span class="preprocessor"></span>  <span class="comment">/* Periodic intr. / Square wave rate select. 0=none, 1=32.8kHz,... 15=2Hz */</span>
<a name="l00080"></a><a class="code" href="mc146818_8h.html#a25">00080</a> <span class="preprocessor"># define RTC_RATE_SELECT    0x0F</span>
00081 <span class="preprocessor"></span>
00082 <span class="comment">/**********************************************************************/</span>
<a name="l00083"></a><a class="code" href="mc146818_8h.html#a26">00083</a> <span class="preprocessor"># define RTC_CONTROL    RTC_REG_B</span>
<a name="l00084"></a><a class="code" href="mc146818_8h.html#a27">00084</a> <span class="preprocessor"></span><span class="preprocessor"># define RTC_SET 0x80       </span><span class="comment">/* disable updates for clock setting */</span>
<a name="l00085"></a><a class="code" href="mc146818_8h.html#a28">00085</a> <span class="preprocessor"># define RTC_PIE 0x40       </span><span class="comment">/* periodic interrupt enable */</span>
<a name="l00086"></a><a class="code" href="mc146818_8h.html#a29">00086</a> <span class="preprocessor"># define RTC_AIE 0x20       </span><span class="comment">/* alarm interrupt enable */</span>
<a name="l00087"></a><a class="code" href="mc146818_8h.html#a30">00087</a> <span class="preprocessor"># define RTC_UIE 0x10       </span><span class="comment">/* update-finished interrupt enable */</span>
<a name="l00088"></a><a class="code" href="mc146818_8h.html#a31">00088</a> <span class="preprocessor"># define RTC_SQWE 0x08      </span><span class="comment">/* enable square-wave output */</span>
<a name="l00089"></a><a class="code" href="mc146818_8h.html#a32">00089</a> <span class="preprocessor"># define RTC_DM_BINARY 0x04 </span><span class="comment">/* all time/date values are BCD if clear */</span>
<a name="l00090"></a><a class="code" href="mc146818_8h.html#a33">00090</a> <span class="preprocessor"># define RTC_24H 0x02       </span><span class="comment">/* 24 hour mode - else hours bit 7 means pm */</span>
<a name="l00091"></a><a class="code" href="mc146818_8h.html#a34">00091</a> <span class="preprocessor"># define RTC_DST_EN 0x01    </span><span class="comment">/* auto switch DST - works f. USA only */</span>
00092 
00093 <span class="comment">/**********************************************************************/</span>
<a name="l00094"></a><a class="code" href="mc146818_8h.html#a35">00094</a> <span class="preprocessor">#define RTC_INTR_FLAGS  RTC_REG_C</span>
00095 <span class="preprocessor"></span><span class="comment">/* caution - cleared by read */</span>
<a name="l00096"></a><a class="code" href="mc146818_8h.html#a36">00096</a> <span class="preprocessor"># define RTC_IRQF 0x80      </span><span class="comment">/* any of the following 3 is active */</span>
<a name="l00097"></a><a class="code" href="mc146818_8h.html#a37">00097</a> <span class="preprocessor"># define RTC_PF 0x40</span>
<a name="l00098"></a><a class="code" href="mc146818_8h.html#a38">00098</a> <span class="preprocessor"></span><span class="preprocessor"># define RTC_AF 0x20</span>
<a name="l00099"></a><a class="code" href="mc146818_8h.html#a39">00099</a> <span class="preprocessor"></span><span class="preprocessor"># define RTC_UF 0x10</span>
00100 <span class="preprocessor"></span>
00101 <span class="comment">/**********************************************************************/</span>
<a name="l00102"></a><a class="code" href="mc146818_8h.html#a40">00102</a> <span class="preprocessor">#define RTC_VALID   RTC_REG_D</span>
<a name="l00103"></a><a class="code" href="mc146818_8h.html#a41">00103</a> <span class="preprocessor"></span><span class="preprocessor"># define RTC_VRT 0x80       </span><span class="comment">/* valid RAM and time */</span>
00104 <span class="comment">/**********************************************************************/</span>
00105 
00106 <span class="comment">/* example: !(CMOS_READ(RTC_CONTROL) &amp; RTC_DM_BINARY)</span>
00107 <span class="comment"> * determines if the following two #defines are needed</span>
00108 <span class="comment"> */</span>
00109 <span class="preprocessor">#ifndef BCD_TO_BIN</span>
<a name="l00110"></a><a class="code" href="mc146818_8h.html#a42">00110</a> <span class="preprocessor"></span><span class="preprocessor">#define BCD_TO_BIN(val) (((val) &amp; 0xF) + ((val) &gt;&gt; 4) * 10)</span>
00111 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00112 <span class="preprocessor"></span>
00113 <span class="preprocessor">#ifndef BIN_TO_BCD</span>
<a name="l00114"></a><a class="code" href="mc146818_8h.html#a43">00114</a> <span class="preprocessor"></span><span class="preprocessor">#define BIN_TO_BCD(val) ((((val) / 10) &lt;&lt; 4) + (val) % 10)</span>
00115 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00116 <span class="preprocessor"></span>
00117 <span class="comment">/*</span>
00118 <span class="comment"> */</span>
00119 
<a name="l00120"></a><a class="code" href="structrtc__time__t.html">00120</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>
00121 <span class="keyword"></span>{
<a name="l00122"></a><a class="code" href="structrtc__time__t.html#o0">00122</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> seconds;
<a name="l00123"></a><a class="code" href="structrtc__time__t.html#o1">00123</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> minutes;
<a name="l00124"></a><a class="code" href="structrtc__time__t.html#o2">00124</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hours;
<a name="l00125"></a><a class="code" href="structrtc__time__t.html#o3">00125</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> day_of_week;
<a name="l00126"></a><a class="code" href="structrtc__time__t.html#o4">00126</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> day_of_month;
<a name="l00127"></a><a class="code" href="structrtc__time__t.html#o5">00127</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> month;
<a name="l00128"></a><a class="code" href="structrtc__time__t.html#o6">00128</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  year;
00129 } <a class="code" href="structrtc__time__t.html">rtc_time_t</a>;
00130 
00131 <span class="preprocessor">#endif </span><span class="comment">/* _MC146818RTC_H */</span>
</div></pre>  </body>
</html>
